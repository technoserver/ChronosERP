grupos

mensagem ao abri o cadastro de grupos



CREATE OR REPLACE VIEW view_pessoa_cliente_empresa AS
 SELECT c.id,
    c.id_operacao_fiscal,
    c.id_pessoa,
    c.id_atividade_for_cli,
    c.id_situacao_for_cli,
    empresa.id as id_empresa,
    c.desde,
    c.data_cadastro,
    c.observacao,
    c.conta_tomador,
    c.gera_financeiro,
    c.indicador_preco,
    c.porcento_desconto,
    c.forma_desconto,
    c.limite_credito,
    c.tipo_frete,
    e.logradouro,
    e.numero,
    e.complemento,
    e.bairro,
    e.cidade,
    e.cep,
    e.municipio_ibge,
    e.uf,
    e.fone,
    p.nome,
    p.tipo,
    p.email,
    p.site,
    pf.cpf AS cpf_cnpj,
    pf.rg AS rg_ie,
    empresa.razao_social AS empresa_razao_social,
    empresa.nome_fantasia AS empresa_nome_fantasia,
    empresa.cnpj AS empresa_cnpj,
    empresa.inscricao_estadual AS empresa_inscricao_estadual,
    empresa.imagem_logotipo AS empresa_imagem_logotipo,
    empresa_endereco.logradouro AS empresa_endereco_logradouro,
    empresa_endereco.numero AS empresa_endereco_numero,
    empresa_endereco.complemento AS empresa_endereco_complemento,
    empresa_endereco.bairro AS empresa_endereco_bairro,
    empresa_endereco.cidade AS empresa_endereco_cidade,
    empresa_endereco.cep AS empresa_endereco_cep,
    empresa_endereco.fone AS empresa_endereco_fone,
    empresa_endereco.uf AS empresa_endereco_uf,
    empresa.email AS empresa_email
   FROM pessoa p
     inner JOIN pessoa_fisica pf ON pf.id_pessoa = p.id
     inner JOIN cliente c ON c.id_pessoa = p.id
     inner JOIN pessoa_endereco e ON e.id_pessoa = p.id
     inner JOIN empresa_pessoa ep ON ep.id_pessoa = p.id
     inner JOIN empresa empresa ON ep.id_empresa = empresa.id
     inner JOIN empresa_endereco empresa_endereco ON empresa_endereco.id_empresa = empresa.id
  WHERE empresa_endereco.principal = 'S' and p.cliente = 'S' AND e.principal = 'S'
UNION
 SELECT c.id,
    c.id_operacao_fiscal,
    c.id_pessoa,
    c.id_atividade_for_cli,
    c.id_situacao_for_cli,
    empresa.id as id_empresa,
    c.desde,
    c.data_cadastro,
    c.observacao,
    c.conta_tomador,
    c.gera_financeiro,
    c.indicador_preco,
    c.porcento_desconto,
    c.forma_desconto,
    c.limite_credito,
    c.tipo_frete,
    e.logradouro,
    e.numero,
    e.complemento,
    e.bairro,
    e.cidade,
    e.cep,
    e.municipio_ibge,
    e.uf,
    e.fone,
    p.nome,
    p.tipo,
    p.email,
    p.site,
    pj.cnpj AS cpf_cnpj,
    pj.inscricao_estadual,
    empresa.razao_social AS empresa_razao_social,
    empresa.nome_fantasia AS empresa_nome_fantasia,
    empresa.cnpj AS empresa_cnpj,
    empresa.inscricao_estadual AS empresa_inscricao_estadual,
    empresa.imagem_logotipo AS empresa_imagem_logotipo,
    empresa_endereco.logradouro AS empresa_endereco_logradouro,
    empresa_endereco.numero AS empresa_endereco_numero,
    empresa_endereco.complemento AS empresa_endereco_complemento,
    empresa_endereco.bairro AS empresa_endereco_bairro,
    empresa_endereco.cidade AS empresa_endereco_cidade,
    empresa_endereco.cep AS empresa_endereco_cep,
    empresa_endereco.fone AS empresa_endereco_fone,
    empresa_endereco.uf AS empresa_endereco_uf,
    empresa.email AS empresa_email
   FROM pessoa p
     inner JOIN pessoa_juridica pj ON pj.id_pessoa = p.id
     inner JOIN cliente c ON c.id_pessoa = p.id
     inner JOIN pessoa_endereco e ON e.id_pessoa = p.id
     inner JOIN empresa_pessoa ep ON ep.id_pessoa = p.id
     inner JOIN empresa empresa ON ep.id_empresa = empresa.id
     inner JOIN empresa_endereco empresa_endereco ON empresa_endereco.id_empresa = empresa.id
  WHERE empresa_endereco.principal = 'S' and  p.cliente = 'S' AND e.principal = 'S';




criar os relacionamento da empresa produto

colocar o crt da empresa na populacao dos dados