grupos

mensagem ao abri o cadastro de grupos



definir a senha padrao do usuario


colocar o crt da empresa na populacao dos dados

cria campo valorTotalTributos em nfecabecalho




cria coluna de de data de movimento em movimento_produto


select
   p.nome,sum(p.quantidade) as quantidade,
   ROUND(sum(p.porcentagem),2) as porcetagem,
   empresa_razao_social,
   empresa_nome_fantasia,
   empresa_cnpj,
   empresa_inscricao_estadual,
   empresa_imagem_logotipo,
   empresa_endereco_logradouro,
   empresa_endereco_numero,
   empresa_endereco_complemento,
   empresa_endereco_bairro,
   empresa_endereco_cidade,
   empresa_endereco_cep,
   empresa_endereco_fone,
   empresa_endereco_uf,
   empresa_email
 from (SELECT
        CASE
            WHEN (sum(i.quantidade) * 100.0 / sum(sum(i.quantidade)) OVER ()) <= 1::numeric THEN 'OUTROS'::character varying
            ELSE p.nome
        END AS nome,
    sum(i.quantidade) AS quantidade,
    sum(i.quantidade) * 100.0 / sum(sum(i.quantidade)) OVER () AS porcentagem
   FROM produto p
     INNER JOIN venda_detalhe i ON i.id_produto = p.id
     INNER JOIN venda_cabecalho v ON i.id_venda_cabecalho = v.id
     INNER JOIN pdv_venda_detalhe pi ON pi.id_produto = p.id
     INNER JOIN pdv_venda_cabecalho pv ON pi.id_pdv_venda_cabecalho = pv.id
   WHERE v.data_venda BETWEEN $P{dataInicial} and $P{dataFinal}
  GROUP BY p.nome) as p,view_dados_empresa
group by p.nome,empresa_razao_social,empresa_nome_fantasia,
   empresa_cnpj,
   empresa_inscricao_estadual,
   empresa_imagem_logotipo,
   empresa_endereco_logradouro,
   empresa_endereco_numero,
   empresa_endereco_complemento,
   empresa_endereco_bairro,
   empresa_endereco_cidade,
   empresa_endereco_cep,
   empresa_endereco_fone,
   empresa_endereco_uf,
   empresa_email
order by 3 desc


