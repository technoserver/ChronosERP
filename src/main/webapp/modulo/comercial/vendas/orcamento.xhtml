<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns="http://www.w3.org/1999/xhtml"
                template="/WEB-INF/layout/layoutPadrao.xhtml"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:p="http://primefaces.org/ui"
                xmlns:erp="http://java.sun.com/jsf/composite/components"
                xmlns:f="http://xmlns.jcp.org/jsf/core">

    <ui:define name="title">
        #{vendaOrcamentoCabecalhoControll.tipo eq 'O'?'Orçamento':'PEDIDO'}
    </ui:define>

    <ui:define name="tela">
        #{vendaOrcamentoCabecalhoControll.titulo}
    </ui:define>
    <ui:define name="controle">
        #{vendaOrcamentoCabecalhoControll.tipo eq 'O'?'Orçamento':'PEDIDO'}
    </ui:define>


    <ui:define name="metadata">
        <f:metadata>
            <f:viewParam name="tipo" value="#{vendaOrcamentoCabecalhoControll.tipo}"/>
        </f:metadata>
    </ui:define>
    <ui:define name="gridDados">

        <p:outputPanel id="outputPanelGrid">
            <p:outputPanel rendered="#{vendaOrcamentoCabecalhoControll.telaGrid}">
                <div class="ibox-content">
                    <erp:msgPermissao permissao="#{vendaOrcamentoCabecalhoControll.podeConsultar()}"/>
                    <div class="row m-b">

                        <erp:campoData nomeAtributo="#{vendaOrcamentoCabecalhoControll.dataInicial}"
                                       label="Data inicial"
                                       idComponente="dataInicial"
                                       styleClass="col-xs-12 col-sm-2 col-md-2"/>

                        <erp:campoData nomeAtributo="#{vendaOrcamentoCabecalhoControll.dataFinal}"
                                       label="Data Final"
                                       idComponente="dataFinal"
                                       styleClass="col-xs-12 col-sm-2 col-md-2"/>

                        <erp:campoSelect itens="#{vendaOrcamentoCabecalhoControll.listaVendedor}"
                                         styleClass="col-xs-12 col-sm-4 col-md-4"
                                         idComponente="vendedor"
                                         label="Vendedor"

                                         nomeAtributo="#{vendaOrcamentoCabecalhoControll.idvendedor}"/>

                        <erp:campoSelect itens="#{vendaOrcamentoCabecalhoControll.situacoes}"
                                         styleClass="col-xs-12 col-sm-2 col-md-2"
                                         idComponente="status"
                                         label="Status"

                                         nomeAtributo="#{vendaOrcamentoCabecalhoControll.status}"/>

                        <erp:campoTexto nomeAtributo="#{vendaOrcamentoCabecalhoControll.codigo}"
                                        styleClass="col-xs-12 col-sm-2 col-md-2"
                                        idComponente="codigo"
                                        label="Código"
                                        tamanhoMaximo="12"/>

                        <erp:campoTexto nomeAtributo="#{vendaOrcamentoCabecalhoControll.cliente}"
                                        styleClass="col-xs-12 col-sm-12 col-md-12"
                                        idComponente="cliente"
                                        label="Cliente"
                                        tamanhoMaximo="100"/>

                        <div class="col-xs-12 col-sm-12 col-md-12 text-center m-t">

                            <p:commandButton title="Pesquisar"
                                             value="Pesquisar"
                                             action="#{vendaOrcamentoCabecalhoControll.pesquisar}"
                                             update="tableOrcamento"
                            >

                            </p:commandButton>

                        </div>

                    </div>
                    <p:dataTable
                            value="#{vendaOrcamentoCabecalhoControll.dataModel}"
                            var="row" id="tableOrcamento" paginator="true"
                            rows="10" rowsPerPageTemplate="10,20,30,40" paginatorPosition="bottom"
                            reflow="true" rendered="#{vendaOrcamentoCabecalhoControll.podeConsultar()}"
                            lazy="true" sortBy="#{row.id}" sortOrder="descending">


                        <p:column headerText="Cliente">
                            <h:outputLabel value="#{row.cliente.pessoa.nome}"/>
                        </p:column>
                        <p:column headerText="Vendedor">
                            <h:outputLabel value="#{row.vendedor.colaborador.pessoa.nome}"/>
                        </p:column>
                        <p:column headerText="Codigo" width="110">
                            <h:outputLabel value="#{row.codigo}"/>
                        </p:column>
                        <p:column headerText="Data" styleClass="text-center" width="105">
                            <h:outputLabel value="#{row.dataCadastro}">
                                <f:convertDateTime pattern="dd/MM/yyyy"/>
                            </h:outputLabel>
                        </p:column>
                        <p:column headerText="Valor Total" styleClass="text-right" width="130">
                            <h:outputLabel value="#{row.valorTotal}">
                                <f:convertNumber pattern="#,##0.00"/>
                            </h:outputLabel>
                        </p:column>
                        <p:column headerText="Status" width="120" styleClass="text-center">
                            <h:outputLabel
                                    value="#{vendaOrcamentoCabecalhoControll.keyFromValue(vendaOrcamentoCabecalhoControll.orcamentoSituacao,row.situacao)}"/>
                        </p:column>
                        <p:column headerText="Ações" width="170" class="text-center">
                            <p:commandLink title="Alterar" action="#{vendaOrcamentoCabecalhoControll.doEdit()}"
                                           class=" btn btn-default"
                                           oncomplete="addClass()"
                                           update=":formCentro:outputPanelGrid,:formCentro:outputPanelDetalhe,navegacao,:formCentro:mensagem"
                                           rendered="#{row.situacao eq 'P'}">
                                <i class="fa fa-file-text-o"></i>
                                <f:setPropertyActionListener value="#{row}"
                                                             target="#{vendaOrcamentoCabecalhoControll.objetoSelecionado}"/>
                            </p:commandLink>

                            &nbsp;
                            <p:commandLink title="Excluir" action="#{vendaOrcamentoCabecalhoControll.remover()}"

                                           update=":formCentro:growl,:formCentro:outputPanelGrid,:formCentro:outputPanelDetalhe"
                                           process="tableOrcamento"
                                           oncomplete="atualizarMsg();"
                                           class="btn btn-default"
                                           rendered="#{row.situacao eq 'P'}"
                            >
                                <i class="fa fa-times"></i>
                                <p:confirm header="Confirmar" message="Deseja excluir ?"/>

                                <f:setPropertyActionListener value="#{row}"
                                                             target="#{vendaOrcamentoCabecalhoControll.objetoSelecionado}"/>
                            </p:commandLink>
                            &nbsp;
                            <p:menuButton>

                                <p:menuitem value="Imprimir A4"
                                            target="_blank"
                                            actionListener="#{vendaRelatorioControll.imprimirOrcamento(row.id)}"
                                            icon="fa fa-print" ajax="false"/>
                                <p:menuitem value="Imprimir Cupom"
                                            target="_blank"
                                            actionListener="#{vendaRelatorioControll.imprimirOrcamentoCupom(row.id)}"
                                            icon="fa fa-print"
                                            ajax="false"/>

                                <p:menuitem value="Gerar OS"
                                            rendered="#{row.tipo eq 'O'}"
                                            outcome="/modulo/comercial/os/osAbertura">
                                    <f:param name="orcamento" value="#{row.id}"/>
                                </p:menuitem>


                                <p:menuitem value="Aprovar e Gerar Pedido"
                                            update=":formCentro:growl,tableOrcamento"
                                            rendered="#{row.tipo eq 'O'}"
                                            action="#{vendaOrcamentoCabecalhoControll.gerarPedido}">
                                    <f:setPropertyActionListener value="#{row}"
                                                                 target="#{vendaOrcamentoCabecalhoControll.objetoSelecionado}"/>
                                </p:menuitem>

                                <p:menuitem value="Aprovar"
                                            update=":formCentro:growl,tableOrcamento"
                                            rendered="#{row.tipo eq 'P' and (row.situacao eq 'P') }"
                                            action="#{vendaOrcamentoCabecalhoControll.aprovarPedido}">
                                    <f:setPropertyActionListener value="#{row}"
                                                                 target="#{vendaOrcamentoCabecalhoControll.objetoSelecionado}"/>
                                </p:menuitem>


                                <p:menuitem value="Faturar"
                                            update=":formCentro:growl,tableOrcamento"
                                            rendered="#{row.tipo eq 'P' and (row.situacao eq 'A') }"
                                            action="#{vendaOrcamentoCabecalhoControll.gerarVenda}">
                                    <f:setPropertyActionListener value="#{row}"
                                                                 target="#{vendaOrcamentoCabecalhoControll.objetoSelecionado}"/>
                                </p:menuitem>

                            </p:menuButton>

                        </p:column>


                    </p:dataTable>

                </div>

                <div class="ibox-footer">
                    <div class="row">
                        <div class="col-xs-6 col-lg-6">
                            <h:commandButton value="Cadastrar" class="btn btn-primary center-block"
                                             actionListener="#{vendaOrcamentoCabecalhoControll.doCreate()}"
                                             disabled="#{!vendaOrcamentoCabecalhoControll.podeInserir()}"
                            >
                                <p:ajax process="@form"
                                        oncomplete="addClass()"
                                        update=":formCentro:outputPanelGrid,:formCentro:outputPanelDetalhe,navegacao,:formCentro:mensagem"/>
                            </h:commandButton>
                        </div>
                        <div class="col-xs-6 col-lg-6">
                            <h:commandButton value="Cancelar" class="btn btn-default center-block"
                                             action="#{vendaOrcamentoCabecalhoControll.doIndex()}" immediate="true"
                            />

                        </div>


                    </div>
                </div>

            </p:outputPanel>

        </p:outputPanel>


    </ui:define>


    <ui:define name="telaInclusaoAlteracao">

        <h:panelGroup layout="block" id="outputPanelDetalhe">
            <h:panelGroup layout="block" rendered="#{!vendaOrcamentoCabecalhoControll.telaGrid}">

                <h:panelGroup layout="block" id="panelCentroDetalhe">
                    <div class="ibox-content">
                        <div class="row">
                            <div class="col-md-12">

                                <h:panelGroup layout="block" id="panelValores" styleClass="row">

                                    <div class="col-lg-4 col-xs-6">
                                        <!-- small box -->
                                        <div class="small-box bg-gray">
                                            <div class="inner">
                                                <h3>R$
                                                    <span>
                                                        <h:outputText
                                                                value="#{vendaOrcamentoCabecalhoControll.objeto.valorTotal}">
                                                            <f:convertNumber pattern="#,##0.00"/>
                                                        </h:outputText>
                                                    </span>
                                                </h3>

                                                <p>Valor Total</p>
                                            </div>
                                            <div class="icon" style="top: 0px">
                                                <i class="fa  fa-money"></i>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-lg-4 col-xs-6">
                                        <!-- small box -->
                                        <div class="small-box bg-gray">
                                            <div class="inner">
                                                <h3>R$
                                                    <span>
                                                        <h:outputText
                                                                value="#{vendaOrcamentoCabecalhoControll.objeto.valorSubtotal}">
                                                            <f:convertNumber pattern="#,##0.00"/>
                                                        </h:outputText>
                                                    </span>
                                                </h3>

                                                <p>Valor Produtos</p>
                                            </div>
                                            <div class="icon" style="top: 0px">
                                                <i class="fa fa-shopping-cart"></i>
                                            </div>
                                        </div>
                                    </div>


                                    <div class="col-lg-4 col-xs-6">
                                        <!-- small box -->
                                        <div class="small-box bg-gray">
                                            <div class="inner">

                                                <h3>
                                                    R$
                                                    <span>
                                                            <h:outputText
                                                                    value="#{vendaOrcamentoCabecalhoControll.objeto.valorDesconto}">
                                                                <f:convertNumber pattern="#,##0.00"/>
                                                            </h:outputText>
                                                        </span>
                                                    <p:commandLink styleClass="btn btn-link"
                                                                   title="Aplicar desconto no valor total"
                                                                   update=":formOutrasTelas2:panelOutrasTelas2"
                                                                   disabled="#{vendaOrcamentoCabecalhoControll.objeto.valorTotal.signum() eq 0}"
                                                                   oncomplete="PF('dialogOutrasTelas2').show()">
                                                        <i class="fa fa-pencil fa-2x" aria-hidden="true"></i>
                                                    </p:commandLink>

                                                    <p:commandLink styleClass="btn btn-link"
                                                                   title="Remover Desconto"
                                                                   action="#{vendaOrcamentoCabecalhoControll.removerDesconto}"
                                                                   process="@this"
                                                                   update=":formCentro:growl,:formCentro:panelValores,:formCentro:tableOrcamento"
                                                                   rendered="#{vendaOrcamentoCabecalhoControll.objeto.valorDesconto.signum() ne 0}">
                                                        <i class="fa fa-ban fa-2x" aria-hidden="true"></i>
                                                    </p:commandLink>
                                                </h3>


                                                <p>Valor do Desconto</p>
                                            </div>
                                            <div class="icon" style="top: 0px">
                                                <i class="fa fa-percent" aria-hidden="true"></i>
                                            </div>
                                        </div>
                                    </div>

                                </h:panelGroup>

                                <div class="row">


                                    <div class="col-xs-12 col-sm-4 col-md-4">
                                        <p:outputLabel value="Cliente" for="cliente"/>
                                        <div class="field-action">
                                            <p:autoComplete id="cliente"
                                                            value="#{vendaOrcamentoCabecalhoControll.objeto.cliente}"
                                                            completeMethod="#{vendaOrcamentoCabecalhoControll.getListaCliente}"
                                                            var="objeto" itemLabel="#{objeto.pessoa.nome}"
                                                            itemValue="#{objeto}"
                                                            queryDelay="500"
                                                            style="width: 100%"
                                                            converter="defaultConverter" forceSelection="true"
                                                            minQueryLength="3" maxResults="10" required="true"
                                                            emptyMessage="Nenhum registro encontrado">>


                                            </p:autoComplete>
                                            <div class="field-action__icon">
                                                <p:commandLink title="Add novo cliente"
                                                               style="font-size: 20px;color: #00acac"
                                                               action="#{CadastroRapidoClienteControll.abrirDialog}"
                                                               process="@this" update="@none"
                                                >
                                                    <p:ajax event="dialogReturn"
                                                            listener="#{vendaOrcamentoCabecalhoControll.clienteSelecionado}"
                                                            process="@this" update="cliente"/>
                                                    <i class="fa fa-plus-circle"></i>
                                                </p:commandLink>
                                            </div>


                                        </div>
                                    </div>


                                    <erp:autoComplete styleClass="col-xs-12 col-sm-4 col-md-4"
                                                      label="Vendedor"
                                                      itemLabel="#{objeto.colaborador.pessoa.nome}"
                                                      controller="#{vendaOrcamentoCabecalhoControll}"
                                                      completeMethod="getListaVendedor"
                                                      nomeAtributo="#{vendaOrcamentoCabecalhoControll.objeto.vendedor}"
                                                      idComponente="vendaOrcamentoCabecalhoVendedor">
                                        <p:ajax event="itemSelecionado"
                                                listener="#{vendaOrcamentoCabecalhoControll.definirTaxaComissao}"
                                        />
                                    </erp:autoComplete>

                                    <erp:autoComplete styleClass="col-xs-12 col-sm-4 col-md-4"
                                                      label="Condicoes Pagamento"
                                                      itemLabel="#{objeto.nome}"
                                                      controller="#{vendaOrcamentoCabecalhoControll}"
                                                      completeMethod="getListaVendaCondicoesPagamento"
                                                      nomeAtributo="#{vendaOrcamentoCabecalhoControll.objeto.condicoesPagamento}"
                                                      idComponente="vendaOrcamentoCabecalhoVendaCondicoesPagamento"/>


                                </div>
                                <div class="row">
                                    <erp:campoData label="Entrega em"
                                                   styleClass="col-xs-12 col-sm-2 col-md-2"
                                                   idComponente="dataEntrega"
                                                   nomeAtributo="#{vendaOrcamentoCabecalhoControll.objeto.dataEntrega}"/>
                                </div>
                                <div class="row">
                                    <erp:campoAreaTexto styleClass="col-xs-12 col-sm-12 col-md-12"
                                                        idComponente="vendaOrcamentoCabecalhoObservacao"
                                                        label="Observacao"
                                                        nomeAtributo="#{vendaOrcamentoCabecalhoControll.objeto.observacao}"/>
                                </div>
                                <erp:separador label="Produtos"/>
                                <div class="row">
                                    <div class="col-md-12">
                                        <h:commandLink title="Novo" class="btn btn-default"
                                                       actionListener="#{vendaOrcamentoCabecalhoControll.incluirVendaOrcamentoDetalhe}"
                                                       type="button"
                                        >
                                            <i class="glyphicon glyphicon-plus"/>
                                            <p:ajax update=":formOutrasTelas:panelVendaOrcamentoDetalhe,dataTableVendaOrcamentoDetalhe"
                                                    oncomplete="PF('dialogVendaOrcamentoDetalhe').show()"
                                                    process="@this,dataTableVendaOrcamentoDetalhe"/>
                                        </h:commandLink>
                                    </div>
                                </div>
                                <p:dataTable id="dataTableVendaOrcamentoDetalhe" var="obj"
                                             value="#{vendaOrcamentoCabecalhoControll.objeto.listaVendaOrcamentoDetalhe}"
                                             paginator="true" rows="10" rowsPerPageTemplate="10,20,30,40"
                                             reflow="true"
                                             rowKey="#{obj.id}" paginatorPosition="bottom">


                                    <p:column headerText="Produto">
                                        <h:outputLabel value="#{obj.produto.nome}"/>
                                    </p:column>
                                    <p:column headerText="QTD." styleClass="text-center" width="110">
                                        <h:outputLabel value="#{obj.quantidade}">
                                            <f:convertNumber pattern="0.000"/>
                                        </h:outputLabel>
                                    </p:column>
                                    <p:column headerText="Valor UN" styleClass="text-right" width="110">
                                        <h:outputLabel value="#{obj.valorUnitario}">
                                            <f:convertNumber pattern="#,##0.00"/>
                                        </h:outputLabel>
                                    </p:column>
                                    <p:column headerText="Subtotal" styleClass="text-right" width="150">
                                        <h:outputLabel value="#{obj.valorSubtotal}">
                                            <f:convertNumber pattern="#,##0.00"/>
                                        </h:outputLabel>
                                    </p:column>
                                    <p:column headerText="Desc." styleClass="text-right" width="100">
                                        <h:outputLabel value="#{obj.valorDesconto}">
                                            <f:convertNumber pattern="#,##0.00"/>
                                        </h:outputLabel>
                                    </p:column>
                                    <p:column headerText="Total" styleClass="text-right" width="200">
                                        <h:outputLabel value="#{obj.valorTotal}">
                                            <f:convertNumber pattern="#,##0.00"/>
                                        </h:outputLabel>
                                    </p:column>
                                    <p:column headerText="Ações" width="120" styleClass="text-center">
                                        <p:commandLink title="Alterar"
                                                       process="dataTableVendaOrcamentoDetalhe"
                                                       id="btnAlterarProduto"
                                                       action="#{vendaOrcamentoCabecalhoControll.alterarVendaOrcamentoDetalhe}"
                                                       class=" btn btn-default"
                                                       oncomplete="PF('dialogVendaOrcamentoDetalhe').show()"
                                                       update=":formOutrasTelas:panelVendaOrcamentoDetalhe,dataTableVendaOrcamentoDetalhe"
                                        >
                                            <i class="fa fa-file-text-o"></i>
                                            <f:setPropertyActionListener value="#{obj}"
                                                                         target="#{vendaOrcamentoCabecalhoControll.vendaOrcamentoDetalheSelecionado}"/>
                                        </p:commandLink>
                                        &nbsp;
                                        <p:commandLink title="Excluir"
                                                       id="btnExluirProduto"
                                                       action="#{vendaOrcamentoCabecalhoControll.excluirVendaOrcamentoDetalhe}"
                                                       style="position: relative; right: 7px"
                                                       update=":formCentro:growl,dataTableVendaOrcamentoDetalhe,,:formCentro:panelValores"
                                                       process="dataTableVendaOrcamentoDetalhe"
                                                       oncomplete="atualizarMsg();"
                                                       class="btn btn-default"
                                        >
                                            <i class="fa fa-times"></i>
                                            <p:confirm header="Confirmar" message="Deseja excluir ?"/>

                                            <f:setPropertyActionListener value="#{obj}"
                                                                         target="#{vendaOrcamentoCabecalhoControll.vendaOrcamentoDetalheSelecionado}"/>
                                        </p:commandLink>
                                    </p:column>


                                </p:dataTable>

                            </div>
                        </div>
                    </div>

                    <div class="ibox-footer">
                        <h:panelGroup layout="block" rendered="#{not empty vendaOrcamentoCabecalhoControll.objeto}">


                            <div class="row">
                                <div class="col-xs-6 col-lg-6 text-center">
                                    <h:panelGroup layout="block" class="btn-group"
                                                  rendered="#{ vendaOrcamentoCabecalhoControll.objeto.situacao ne 'F' and not vendaOrcamentoCabecalhoControll.objeto.situacao ne 'C'}">

                                        <p:commandButton value="Salvar"
                                                         id="btnSalvar"
                                                         rendered="#{empty vendaOrcamentoCabecalhoControll.objeto.id}"
                                                         action="#{vendaOrcamentoCabecalhoControll.salvar()}"
                                                         disabled="#{!vendaOrcamentoCabecalhoControll.podeInserir()}"
                                                         process="@form"
                                                         oncomplete="addClass()"
                                                         update=":formCentro:growl,:formCentro:outputPanelDetalhe,navegacao,:formCentro:mensagem">

                                        </p:commandButton>


                                        <p:splitButton value="Salvar"
                                                       rendered="#{not empty vendaOrcamentoCabecalhoControll.objeto.id and
                                                       vendaOrcamentoCabecalhoControll.objeto.situacao ne 'F'}"
                                                       actionListener="#{vendaOrcamentoCabecalhoControll.salvar}"
                                                       icon="ui-icon-disk">

                                            <p:menuitem value="Aprovar"
                                                        actionListener="#{vendaOrcamentoCabecalhoControll.aprovarPedido}"
                                                        update=":formCentro:growl,formCentro:mensagem,:formCentro:outputPanelDetalhe,:formCentro:outputPanelGrid"
                                                        rendered="#{vendaOrcamentoCabecalhoControll.objeto.tipo eq 'P' and vendaOrcamentoCabecalhoControll.objeto.situacao eq 'P'}"
                                                        icon="ui-icon-arrowrefresh-1-w"/>

                                            <p:menuitem value="Faturar"
                                                        actionListener="#{vendaOrcamentoCabecalhoControll.gerarVenda}"
                                                        update=":formCentro:growl,formCentro:mensagem,:formCentro:outputPanelDetalhe,:formCentro:outputPanelGrid"
                                                        rendered="#{vendaOrcamentoCabecalhoControll.objeto.tipo eq 'P' and (vendaOrcamentoCabecalhoControll.objeto.situacao eq 'A'
                                                         or vendaOrcamentoCabecalhoControll.objeto.situacao eq 'P')}"
                                                        icon="ui-icon-arrowrefresh-1-w"/>

                                        </p:splitButton>


                                    </h:panelGroup>

                                </div>
                                <div class="#{vendaOrcamentoCabecalhoControll.objeto.situacao eq 'A'} ? 'col-xs-12 col-lg-12' : 'col-xs-6 col-lg-6'">
                                    <h:commandButton value="Cancelar" styleClass="btn btn-default center-block"
                                                     actionListener="#{vendaOrcamentoCabecalhoControll.voltar()}"
                                    >
                                        <p:ajax update=":formCentro:outputPanelDetalhe,:formCentro:outputPanelGrid,navegacao,:formCentro:mensagem"
                                                process="@this"/>
                                    </h:commandButton>
                                </div>
                            </div>


                        </h:panelGroup>
                    </div>

                </h:panelGroup>

            </h:panelGroup>
        </h:panelGroup>

    </ui:define>

    <ui:define name="outrasTelas">
        <h:form id="formOutrasTelas">

            <p:dialog id="dialogVendaOrcamentoDetalhe" responsive="true"
                      header="Inclusão/Alteração Venda Orcamento Detalhe"
                      widgetVar="dialogVendaOrcamentoDetalhe" showEffect="slide"
                      hideEffect="slide" resizable="true" modal="true" closable="false"
                      width="800">

                <p:outputPanel id="panelVendaOrcamentoDetalhe">
                    <div class="row">
                        <erp:autoComplete styleClass="col-xs-12 col-sm-5 col-md-5"
                                          label="Produto"
                                          itemLabel="#{objeto.nome}"
                                          controller="#{vendaOrcamentoCabecalhoControll}"
                                          completeMethod="getListaProduto"
                                          nomeAtributo="#{vendaOrcamentoCabecalhoControll.vendaOrcamentoDetalhe.produto}"
                                          idComponente="vendaOrcamentoDetalheProduto">
                            <p:ajax event="itemSelecionado" process="@this"
                                    update="formOutrasTelas:panelVendaOrcamentoDetalhe"
                                    listener="#{vendaOrcamentoCabecalhoControll.definirValorVenda}"/>
                        </erp:autoComplete>
                        <erp:campoDecimal styleClass="col-xs-12 col-sm-2 col-md-2"
                                          idComponente="vendaOrcamentoDetalheQuantidade" label="Quantidade"
                                          requerido="true"
                                          nomeAtributo="#{vendaOrcamentoCabecalhoControll.vendaOrcamentoDetalhe.quantidade}"/>


                        <erp:campoDecimal styleClass="col-xs-12 col-sm-3 col-md-3"
                                          idComponente="valorUnitario"
                                          desabilitado="#{!vendaOrcamentoCabecalhoControll.podeAlterarPreco}"
                                          label="Valor"
                                          nomeAtributo="#{vendaOrcamentoCabecalhoControll.vendaOrcamentoDetalhe.valorUnitario}"/>

                        <div class="col-xs-12 col-sm-2 col-md-2">
                            <p:outputLabel value="Desconto" for="desconto"/>
                            <div class="ui-inputgroup">

                                <p:inputNumber id="desconto"
                                               value="#{vendaOrcamentoCabecalhoControll.desconto}"
                                               required="true"
                                               style="width: 100%;"
                                               decimalPlaces="2"
                                               minValue="0"/>


                                <p:commandButton id="btnTipoDesconto"
                                                 action="#{vendaOrcamentoCabecalhoControll.alterarTipoDesconto}"
                                                 process="@this"
                                                 update="formOutrasTelas:btnTipoDesconto"
                                                 value="#{vendaOrcamentoCabecalhoControll.tipoDesconto eq 0 ? '%' : 'R$' }"/>
                            </div>
                        </div>

                    </div>


                </p:outputPanel>
                <f:facet name="footer">
                    <div class="row">
                        <div class="col-md-6 text-center">
                            <p:commandButton value="Salvar"
                                             id="btnSalvarProduto"
                                             actionListener="#{vendaOrcamentoCabecalhoControll.salvarVendaOrcamentoDetalhe}"
                                             update=":formOutrasTelas:panelVendaOrcamentoDetalhe,:formCentro:growl,:formCentro:panelValores,:formCentro:dataTableVendaOrcamentoDetalhe"
                                             oncomplete="if (!args.validationFailed) {PF('dialogVendaOrcamentoDetalhe').hide();}"/>
                        </div>
                        <div class="col-md-6 text-center">
                            <p:commandLink value="Cancelar"
                                           styleClass="btn btn-default"
                                           oncomplete="PF('dialogVendaOrcamentoDetalhe').hide();"/>
                        </div>
                    </div>


                </f:facet>

            </p:dialog>
        </h:form>
    </ui:define>

    <ui:define name="outrasTelas2">
        <h:form id="formOutrasTelas2" class="form-horizontal">

            <p:dialog id="dialogOutrasTelas2"
                      header="Desconto" responsive="true"
                      widgetVar="dialogOutrasTelas2"
                      resizable="false" draggable="false" modal="true"
                      width="400"
            >

                <p:outputPanel id="panelOutrasTelas2">
                    <div class="form-group text-right">
                        <div class="text-right">
                            <label class="control-label col-sm-4">Desonto em</label>
                        </div>

                        <div class="col-sm-3">
                            <h:selectOneMenu id="tipo-desconto" styleClass="form-control"
                                             value="#{ vendaOrcamentoCabecalhoControll.tipoDesconto}">
                                <f:selectItem itemLabel="R$" itemValue="1"/>
                                <f:selectItem itemLabel="%" itemValue="2"/>
                            </h:selectOneMenu>
                        </div>

                        <div class="col-sm-5">
                            <p:inputNumber id="valor-desconto" required="true"
                                           value="#{ vendaOrcamentoCabecalhoControll.desconto}"/>
                        </div>
                    </div>


                </p:outputPanel>
                <f:facet name="footer">

                    <div class="row">
                        <div class="col-xs-6 col-md-6 text-center">
                            <p:commandButton value="Salvar"
                                             id="btnSalvarDesonto"
                                             update="panelOutrasTelas2,:formCentro:growl,:formCentro:panelValores,:formCentro:tableOrcamento"
                                             oncomplete="if (!args.validationFailed) {PF('dialogOutrasTelas2').hide();}"
                                             action="#{vendaOrcamentoCabecalhoControll.aplicarDesconto}"/>


                        </div>
                        <div class="col-xs-6 col-md-6 text-center">
                            <h:commandButton value="Cancelar"
                                             styleClass="btn btn-default">
                                <p:ajax oncomplete="PF('dialogOutrasTelas2').hide();"
                                        process="@this"/>
                            </h:commandButton>
                        </div>
                    </div>
                </f:facet>
            </p:dialog>
        </h:form>

    </ui:define>

</ui:composition>
